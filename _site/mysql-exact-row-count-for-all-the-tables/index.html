<!DOCTYPE html>
<!--
    So Simple Jekyll Theme 3.1.1
    Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/so-simple-theme/blob/master/LICENSE
-->
<html lang="en-US" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="http://localhost:4000">
<script data-ad-client="ca-pub-9518508677792760" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<link rel="apple-touch-icon" sizes="57x57" href="/favicon.ico/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/favicon.ico/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/favicon.ico/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/favicon.ico/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/favicon.ico/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/favicon.ico/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/favicon.ico/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/favicon.ico/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/favicon.ico/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon.ico/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico/favicon-16x16.png">
<link rel="manifest" href="/favicon.ico/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">  
  

  
    <title>MySQL Exact Row Count For All The Tables</title>
    <meta name="description" content="">
    <link rel="canonical" href="http://localhost:4000/mysql-exact-row-count-for-all-the-tables/">
  

  <script>
    /* Cut the mustard */
    if ( 'querySelector' in document && 'addEventListener' in window ) {
      document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + 'js';
    }
  </script>

  <link rel="stylesheet" href="/assets/css/main.css">
  <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  <link rel="stylesheet" href="/assets/css/applause-button.css" />
   <script src="/assets/js/applause-button.js"></script>

</head>


  <body class="layout--post  mysql-exact-row-count-for-all-the-tables">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    
  <div class="navigation-wrapper">
    <a href="#menu-toggle" id="menu-toggle">Menu</a>
    <nav id="primary-nav" class="site-nav animated drop">
      <ul><li><a href="/">Home</a></li><li><a href="/posts/">Posts</a></li><li><a href="/categories/">Categories</a></li><li><a href="/tags/">Tags</a></li><li><a href="https://medium.com/@bhuvithedataguy">BigData Articles</a></li><li><a href="/search/">Search</a></li></ul>
    </nav>
  </div><!-- /.navigation-wrapper -->


    <header class="masthead">
  <div class="wrap">
    
    
    
      
        <div class="site-title animated fadeIn"><a href="/">Nitin Kumar Singh | Data Architect</a></div>
      
      <p class="site-description animated fadeIn" itemprop="description">Mi occupo di web disign, grafica, web writing e sviluppo web.</p>
    
  </div>
</header><!-- /.masthead -->


    <main id="main" class="main-content" aria-label="Content">
  <article class="h-entry">
    

    <div class="page-wrapper">
      <header class="page-header">
        
        
          <h1 id="page-title" class="page-title p-name">MySQL Exact Row Count For All The Tables
</h1>
        

      </header>
      
      <div class="page-sidebar">
        <div class="page-author h-card p-author"><div class="author-info"><div class="author-name">
        <span class="p-name">Nitin Kumar Singh</span>
      </div>
    <time class="page-date dt-published" datetime="2019-02-25T17:05:00+05:30"><a class="u-url" href="">February 25, 2019</a>
</time>

  </div>
</div>

        
  <h3 class="page-taxonomies-title">Categories</h3>
  <ul class="page-taxonomies"><li class="page-taxonomy">mysql</li>
  </ul>


        
  <h3 class="page-taxonomies-title">Tags</h3>
  <ul class="page-taxonomies"><li class="page-taxonomy">mysql</li><li class="page-taxonomy"> shellscript</li>
  </ul>


        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- ad-vertical -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9518508677792760"
     data-ad-slot="4154399056"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
        <br/>
        <br/>
        <applause-button style="width: 58px; height: 58px; text-align:right" color="black" multiclap="true">

      </div>

      <div class="page-content">
        <div class="e-content">

          <p><img src="/uploads/MySQL Exact Row Count For All The Tables.jpg" alt="MySQL Exact Row Count For All The Tables" title="MySQL Exact Row Count For All The Tables" /></p>

<p>Getting the row count from mysql tables are not a big deal and even there is no need for a blog for this. Simply go and query the <code class="highlighter-rouge">INFORMATION</code><code class="highlighter-rouge">_SCHEMA</code> <em>and get the row count for the tables. But this is not your actual row counts. It’ll show the row count of the tables during the last statistics update. So if you want to track your tables growth then you should do</em> <code class="highlighter-rouge">select count(*) from table_name</code> for all the tables and insert the results to somewhere. There are a lot of ways available. Im just make this as a blog post. So others can benefit from it.</p>

<h2 id="row-count---from-stored-procedure">Row Count - From Stored Procedure:</h2>

<p>We’ll get the list of table names from the <code class="highlighter-rouge">information_schema</code> and use <code class="highlighter-rouge">cursor</code> to run <code class="highlighter-rouge">select count(*)</code> on that table and save the row count value to a table.</p>

<p>In this example, Im going to collect the row count of the tables from the database called <code class="highlighter-rouge">prod_db</code>. And this procedure and tracking table will be saved on the database called <code class="highlighter-rouge">dbadmin</code>.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="n">use</span> <span class="n">dbadmin</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">table_growth</span> <span class="p">(</span>  
<span class="n">id</span> <span class="nb">INT</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span>  
<span class="p">,</span><span class="nb">timestamp</span> <span class="nb">DATETIME</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span>  
<span class="p">,</span><span class="k">table_name</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span>  
<span class="p">,</span><span class="k">rows</span> <span class="nb">INT</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span>  
<span class="p">,</span><span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>  
<span class="p">);</span>

<span class="k">delimiter</span> <span class="o">//</span>  
<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="n">rows_growth</span><span class="p">()</span>  
<span class="k">BEGIN</span>  
<span class="k">DECLARE</span> <span class="k">start</span> <span class="nb">INTEGER</span> <span class="k">DEFAULT</span> <span class="mi">0</span><span class="p">;</span>  
<span class="k">DECLARE</span> <span class="n">t_name</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span>  
<span class="k">DEClARE</span> <span class="n">table_names</span> <span class="k">CURSOR</span> <span class="k">FOR</span>  
    	<span class="k">SELECT</span> <span class="k">table_name</span> <span class="k">FROM</span> <span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">TABLES</span> <span class="k">WHERE</span> <span class="n">TABLE_SCHEMA</span><span class="o">=</span><span class="s1">'prod_db'</span><span class="p">;</span>  
<span class="k">DECLARE</span> <span class="k">CONTINUE</span> <span class="k">HANDLER</span>  
        <span class="k">FOR</span> <span class="k">NOT</span> <span class="k">FOUND</span> <span class="k">SET</span> <span class="k">start</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>  
<span class="k">OPEN</span> <span class="n">table_names</span><span class="p">;</span>  
<span class="n">get_tablename</span><span class="p">:</span> <span class="k">table_name</span>  
<span class="k">FETCH</span> <span class="n">table_names</span> <span class="k">INTO</span> <span class="n">t_name</span><span class="p">;</span>  
<span class="k">SET</span> <span class="o">@</span><span class="n">query</span> <span class="o">=</span><span class="n">CONCAT</span><span class="p">(</span><span class="s1">'insert into table_growth (table_name, rows)  select "'</span><span class="p">,</span><span class="n">t_name</span><span class="p">,</span><span class="s1">'" as tablename '</span><span class="p">,</span> <span class="s1">','</span><span class="p">,</span> <span class="s1">'count(*) from prod_db.'</span><span class="p">,</span> <span class="n">t_name</span><span class="p">);</span>  
<span class="k">select</span> <span class="o">@</span><span class="n">query</span><span class="p">;</span>  
<span class="k">PREPARE</span> <span class="n">insert_stmt</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">query</span><span class="p">;</span>  
<span class="k">EXECUTE</span> <span class="n">insert_stmt</span><span class="p">;</span>  
<span class="n">IF</span> <span class="k">start</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">THEN</span>  
<span class="n">LEAVE</span> <span class="n">get_tablename</span><span class="p">;</span>  
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>  
<span class="k">END</span> <span class="k">table_name</span> <span class="n">get_tablename</span><span class="p">;</span>  
<span class="k">CLOSE</span> <span class="n">table_names</span><span class="p">;</span>  
<span class="k">END</span><span class="o">//</span>  
<span class="k">delimiter</span> <span class="p">;</span></code></pre></figure>

<h2 id="row-count---from-shell-script">Row Count - From Shell Script</h2>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">mysql  <span class="nt">-h</span> IP_ADDRESS <span class="nt">-usqladmin</span>  <span class="nt">-p</span><span class="s1">'password!'</span> Foodie  <span class="nt">-N</span> <span class="nt">-e</span> <span class="s2">"SELECT table_name FROM INFORMATION_SCHEMA.tables where table_schema='Foodie';"</span> | <span class="k">while </span><span class="nb">read</span> <span class="nt">-r</span> table_name  
<span class="k">do  
</span><span class="nv">count</span><span class="o">=</span><span class="si">$(</span>mysql <span class="nt">-h</span> IP_ADDRESS <span class="nt">-usqladmin</span>  <span class="nt">-p</span><span class="s1">'password'</span> Foodie <span class="nt">-N</span> <span class="nt">-e</span> <span class="s2">"SELECT COUNT(*) FROM </span><span class="nv">$table_name</span><span class="s2">;"</span><span class="si">)</span>  
mysql  <span class="nt">-h</span> IP_ADDRESS <span class="nt">-usqladmin</span>  <span class="nt">-p</span><span class="s1">'pass!'</span>  dbadmin <span class="nt">-e</span> <span class="s2">"INSERT INTO table_growth (table_name, rows)  VALUES ('</span><span class="nv">$table_name</span><span class="s2">',</span><span class="nv">$count</span><span class="s2">);"</span>  
<span class="k">done</span></code></pre></figure>

<p>If your tables are having a huge amount of data and running with one or two read replica, then use replica’s IP address for doing the <code class="highlighter-rouge">select count(*)</code>.</p>

        </div>
        <hr>
        <h3>Advertisement</h3>
         <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- ad-horizontal -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9518508677792760"
     data-ad-slot="4874591962"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
        <hr>
        <h3> Share this article </h3>
      
        

        

        <nav class="page-pagination" role="navigation">
  
    <a class="page-previous" href="/mysql-devops-automate-database-archive/">
      <h4 class="page-pagination-label">Previous</h4>
      <span class="page-pagination-title">
        <i class="fas fa-arrow-left"></i> MySQL With DevOps 1 - Automate Database Archive

      </span>
    </a>
  

  
    <a class="page-next" href="/mysql-pitr-the-fastest-way-with-devops/">
      <h4 class="page-pagination-label">Next</h4>
      <span class="page-pagination-title">
        MySQL PITR The Fastest Way With DevOps
 <i class="fas fa-arrow-right"></i>
      </span>
    </a>
  
</nav>

      </div>
    </div>
  </article>
</main>


    <footer id="footer" class="site-footer">
  <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
<div class="copyright">
    
      <p>&copy; 2020 Nitin Kumar Singh | Data Architect. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/mmistakes/so-simple-theme" rel="nofollow">So Simple</a>.</p>
    
  </div>
</footer>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>


  </body>

</html>
