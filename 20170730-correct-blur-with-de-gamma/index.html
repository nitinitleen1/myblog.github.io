<!DOCTYPE html><html lang="en-US"><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/assets/Inter.css"/><link rel="stylesheet" href="/assets/atom-one-dark.css"/><title>Correct blur with de-gamma | BLOG.MY</title><link rel="stylesheet" href="/assets/styles.css"/></head><body><nav><a href="/" class="brand_3">BLOG.MY</a><a href="/about" class="link_4">About</a><a href="/archive" class="link_4 siblingLink_5">Archive</a></nav><hr class="hidden_1"/><h1>Correct blur with de-gamma</h1><main><p>I saw a video by <a href="https://www.youtube.com/user/minutephysics" rel="nofollow noopener noreferrer">minutephysics</a> showing how the &quot;blur&quot; operation in almost all softwares is <em>broken</em> and it is all connected to how humans percieve color and how the RGB color values stored in digital media are not the same as the recorded values.</p>
<figure>
    <iframe
        src="https://www.youtube.com/embed/LKnqECcg6Gw?rel=0"
        allow="autoplay;encrypted-media"
        allowfullscreen
    ></iframe>
    <figcaption>Computer Color is Broken - minutephysics</figcaption>
</figure>

<p>According to the <a href="https://wikipedia.org/wiki/Weber–Fechner_law#Vision" rel="nofollow noopener noreferrer">Weber–Fechner law</a> humans perceive brightness logarithmically over a moderate range but more like a power-law over a wider range. A grayscale image with color <code>RGB(0.5, 0.5, 0.5)</code> appears halfway between black and white but it is only 22% bright and <code>RGB(0.25, 0.25, 0.25)</code> appears a quarter between black and white is only 5% bright.</p>
<figure><a href="/20170730-correct-blur-with-de-gamma//images/rgb.jpg" target="_blank"><img alt="Human vision is non-linear" title="Human vision is non-linear" src="/20170730-correct-blur-with-de-gamma//images/rgb.jpg"/></a><figcaption>Human vision is non-linear</figcaption></figure><p>Since we are bad at noticing tiny discrepancies in the brighter regions of the image, we can trade image accuracy for file size by storing the image data as the square-root of the original value. When an image is displayed on the screen, the compressed values are squared-up to give the correct-<em>ish</em> colors.</p>
<figure><a href="/20170730-correct-blur-with-de-gamma//images/process.png" target="_blank"><img alt="Non-linear image storage" title="Non-linear image storage" src="/20170730-correct-blur-with-de-gamma//images/process.png"/></a><figcaption>Non-linear image storage</figcaption></figure><p>Image blurring is done by replacing every pixel in an image with the average of its neighboring pixels.</p>
<figure><a href="/20170730-correct-blur-with-de-gamma//images/blur.png" target="_blank"><img alt="Box blur is simple average of neighboring pixels" title="Box blur is simple average of neighboring pixels" src="/20170730-correct-blur-with-de-gamma//images/blur.png"/></a><figcaption>Box blur is simple average of neighboring pixels</figcaption></figure><p>To get a correct blur, the average must be performed on the original values of the neighboring pixels. The resulting pixels must then be square-rooted</p>
<figure><a href="/20170730-correct-blur-with-de-gamma//images/blur-correct.png" target="_blank"><img alt="Correct blurring" title="Correct blurring" src="/20170730-correct-blur-with-de-gamma//images/blur-correct.png"/></a><figcaption>Correct blurring</figcaption></figure><p>Unfortunately, most software applications do the transformation on the square-rooted values and yield a much darker result.</p>
<figure><a href="/20170730-correct-blur-with-de-gamma//images/blur-incorrect.png" target="_blank"><img alt="Incorrect blurring" title="Incorrect blurring" src="/20170730-correct-blur-with-de-gamma//images/blur-incorrect.png"/></a><figcaption>Incorrect blurring</figcaption></figure><p>Try out the the <a post href="demo">Correct Blur demo</a> to see what a correct blur looks like.</p>
</main><footer class="footer_8"><a href="/20170827-tiny-transfers" class="relatedPosts_9 prevPost_11">⟵ Tiny Transfers</a><a href="/20170622-obfuscation-with-protext/" class="relatedPosts_9 nextPost_10">Obfuscation With Protext ⟶</a></footer></body></html>